!function(){function e(e){try{return(e||0).toFixed(2).replace(".",",")+" €"}catch(e){return"0,00 €"}}function t(){try{return"business"===(localStorage.getItem("solarTool_customerType")&&JSON.parse(localStorage.getItem("solarTool_customerType")).type)}catch(e){return!1}}function n(){try{return!t()}catch(e){return!0}}function o(){try{var e=window.PRODUCT_MAP||window.POPUP_PRODUCT_MAP_NETTO||{},t=window.PRODUCT_MAP_BRUTTO||window.POPUP_PRODUCT_MAP_BRUTTO||{};[e,t].forEach(function(e){Object.keys(e||{}).forEach(function(t){var n=e[t];n&&(n.productId&&(c.productIdToKey[n.productId]=t),n.variantId&&(c.variantIdToKey[n.variantId]=t))})})}catch(e){}}function r(e,t){return t&&c.variantIdToKey[t]||e&&c.productIdToKey[e]||null}function a(){return document.querySelector(".w-commerce-commercecartlist")||document.querySelector(".w-commerce-commercecartcontainerwrapper")}function i(){var e=a();if(!e)return[];var t=Array.from(e.querySelectorAll('.w-commerce-commercecartitem, [data-node-type="commerce-cart-item"]'));return t.map(function(e){for(var t=e.getAttribute("data-commerce-product-id")||(e.querySelector('[data-commerce-product-id]')&&e.querySelector('[data-commerce-product-id]').getAttribute("data-commerce-product-id"))||"",n=e.getAttribute("data-commerce-sku-id")||(e.querySelector('[data-commerce-sku-id]')&&e.querySelector('[data-commerce-sku-id]').getAttribute("data-commerce-sku-id"))||"",o=e.querySelector('input[type="number"], input[data-node-type*="quantity"], .w-commerce-commercecartquantity input, input[name*="quantity" i]'),a=1,i=0;i<['.w-commerce-commercecartproductname','[data-node-type*="product" i]','.text-block-18','.text-block-5','h1,h2,h3,h4,div,span'].length;i++){var u=['.w-commerce-commercecartproductname','[data-node-type*="product" i]','.text-block-18','.text-block-5','h1,h2,h3,h4,div,span'][i];if((l=e.querySelector(u))&&l.textContent.trim()){s=l.textContent.trim();break}}try{var d=parseInt(o&&o.value,10);a=isFinite(d)&&d>0?d:1}catch(e){}var l,s,u="",d=e.querySelector("img");return d&&(u=d.getAttribute("src")||d.getAttribute("data-src")||""),{el:e,productId:t,variantId:n,quantity:a,name:s,img:u,key:r(t,n)}})}function u(e){var t=document.querySelector('form[data-node-type="commerce-add-to-cart-form"][data-commerce-product-id="'+e+'"]')||document.querySelector('form[data-node-type="commerce-add-to-cart-form"][data-commerce-sku-id="'+e+'"]');return t}function d(e){return new Promise(function(t){var n=!1,o=a(),r=setTimeout(function(){n||(n=!0,t())},e||1500);if(!o)return;var i=new MutationObserver(function(){n||(n=!0,clearTimeout(r));try{i.disconnect()}catch(e){}t()});try{i.observe(o,{childList:!0,subtree:!0})}catch(e){}})}function l(e,t){try{var n=e.querySelector('input[name="commerce-add-to-cart-quantity-input"]');n&&(n.value=t)}catch(e){}try{e.querySelectorAll("select[required]").forEach(function(e){if(!e.value){var t=e.querySelector('option[value]:not([value=""])');t&&(e.value=t.value)}})}catch(e){}var o=e.querySelector('input[data-node-type="commerce-add-to-cart-button"], [data-wf-cart-action="add-item"], [data-wf-cart-action*="add" i], input[type="submit"], button[type="submit"]');o&&o.click()}async function s(e,t){if(0!==t){if(t>0){var n=u(e.productId,e.variantId);if(!n)return;var o=d(1500);return l(n,t),await o,void 0}var r=e.el.querySelector('input[type="number"], input[data-node-type*="quantity"], .w-commerce-commercecartquantity input, input[name*="quantity" i]');if(r){var a=parseInt(r.value,10)||1,i=Math.max(0,a+t);return r.value=i,void(r.dispatchEvent(new Event("change",{bubbles:!0})),await d(1500))}var c=f(e.el);if(c){if(c.click(),await d(1500),!(e.quantity+t>0))return;var m=u(e.productId,e.variantId);if(m){var v=d(1500);l(m,e.quantity+t),await v}}}}function f(e){for(var t=['[data-wf-cart-action="remove-item"]','[data-wf-cart-action*="remove" i]','[data-node-type="commerce-cart-remove-link"]','[data-node-type*="remove" i]','a[role="button"][aria-label*="remove" i]','button[aria-label*="remove" i]','.w-commerce-commercecartremovebutton','.w-commerce-commercecartremove'],n=0;n<t.length;n++){var o=e.querySelector(t[n]);if(o)return o}try{var r=Array.from(e.querySelectorAll("a,button,div,span")).filter(function(e){var t=(e.textContent||"").trim().toLowerCase();return"entfernen"===t||"remove"===t||t.indexOf("entfernen")>=0||t.indexOf("remove")>=0});if(r.length)return r[0]}catch(e){}return null}function m(e){var t=0,n=!1;return e.forEach(function(e){var o=e.el.querySelector('.w-commerce-commercecartitemprice, [data-node-type*="price" i]');if(o){var r=(o.textContent||"").toLowerCase(),a=parseFloat(r.replace(/[^0-9,\.]/g,"").replace(".","").replace(",","."));isFinite(a)&&(t+=a,n=!0)}}),{subtotal:t,reliable:n}}function v(){var t=document.getElementById("fp-cart-items");if(t){var n=i();if(t.innerHTML="",!n.length)return t.innerHTML='<div class="fp-empty">Ihr Warenkorb ist leer.</div>',void g(0);n.forEach(function(e){var t=document.createElement("div");t.className="fp-cart-item";var n=document.createElement("img");n.src=e.img||"",n.alt=e.name||"";var o=document.createElement("div"),r=document.createElement("div");r.className="title",r.textContent=e.name||"Produkt";var a=document.createElement("div");a.className="meta",a.textContent=e.key?"Key: "+e.key:e.variantId||e.productId||"",o.appendChild(r),o.appendChild(a);var i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.gap="8px";var u=document.createElement("div");u.className="qty";var f=document.createElement("button");f.className="btn outline",f.style.width="36px",f.textContent="−";var h=document.createElement("input");h.type="number",h.min="0",h.value=String(e.quantity);var y=document.createElement("button");y.className="btn outline",y.style.width="36px",y.textContent="+";var p=document.createElement("button");p.className="btn outline",p.textContent="Entfernen",u.appendChild(f),u.appendChild(h),u.appendChild(y),i.appendChild(u),i.appendChild(p);document.createElement("div").className="price";t.appendChild(n),t.appendChild(o),t.appendChild(i),f.addEventListener("click",async function(){var t=parseInt(h.value,10)||0;t>0&&(h.value=String(t-1),await s(e,-1))}),y.addEventListener("click",async function(){h.value=String((parseInt(h.value,10)||0)+1),await s(e,1)}),h.addEventListener("change",async function(){var t=parseInt(h.value,10);if(!isFinite(t)||t<0)return void(h.value=String(e.quantity));var n=t-e.quantity;0!==n&&await s(e,n)}),p.addEventListener("click",async function(){var t=f=e.el,n=f(o=t);var o;function f(e){for(var t=['[data-wf-cart-action="remove-item"]','[data-wf-cart-action*="remove" i]','[data-node-type="commerce-cart-remove-link"]','[data-node-type*="remove" i]','a[role="button"][aria-label*="remove" i]','button[aria-label*="remove" i]','.w-commerce-commercecartremovebutton','.w-commerce-commercecartremove'],n=0;n<t.length;n++){var o=e.querySelector(t[n]);if(o)return o}try{var r=Array.from(e.querySelectorAll("a,button,div,span")).filter(function(e){var t=(e.textContent||"").trim().toLowerCase();return"entfernen"===t||"remove"===t||t.indexOf("entfernen")>=0||t.indexOf("remove")>=0});if(r.length)return r[0]}catch(e){}return null}n&&(n.click(),await d(1500))}),t.appendChild(t)});var c=m(n);g(c.subtotal)}}function g(o){try{document.getElementById("fp-subtotal").textContent=e(o||0)}catch(e){}var r=document.getElementById("fp-summary-note");r&&(n()?r.textContent="Bei den angebeben Preisen handelt es sich um Nettobeträge. Privatkunden profitieren von 0% MwSt Gemäß §12 Abs. 3 UstG":r.textContent="Firmenkunden wird die MwSt im Bestellprozess berechnet.")}function h(){o();var e=document.getElementById("fp-cart-notice");e&&(e.textContent="Preise netto angezeigt; Kundentyp-Steuerung aktiv.");var t=document.getElementById("fp-clear-all");t&&t.addEventListener("click",async function(){for(var e=i(),t=0;t<e.length;t++){var n=f(e[t].el);n&&(n.click(),await d(1500))}});var n=document.getElementById("fp-checkout");n&&n.addEventListener("click",function(){for(var e=['[data-node-type*="checkout" i]','.w-commerce-commercecartcheckoutbutton','a[href*="checkout" i]'],t=0;t<e.length;t++){var n=document.querySelector(e[t]);if(n){n.click();return}}});var u=a();if(u)try{var l=new MutationObserver(function(){v()});l.observe(u,{childList:!0,subtree:!0})}catch(e){}try{window.CartCompatibility&&"function"==typeof window.CartCompatibility.schedule&&window.CartCompatibility.schedule(200)}catch(e){}v()}var c={productIdToKey:{},variantIdToKey:{}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",h):h()}();


