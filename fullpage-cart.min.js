!function(){function e(){try{return"business"===(localStorage.getItem("solarTool_customerType")&&JSON.parse(localStorage.getItem("solarTool_customerType")).type)}catch(e){return!1}}var t={productIdToKey:{},variantIdToKey:{}};function r(){return document.querySelector(".w-commerce-commercecartlist")||document.querySelector(".w-commerce-commercecartcontainerwrapper")}function n(){var e=r();return e?Array.from(e.querySelectorAll('.w-commerce-commercecartitem, [data-node-type="commerce-cart-item"]')).map(function(e){var r=e.getAttribute("data-commerce-product-id")||e.querySelector("[data-commerce-product-id]")&&e.querySelector("[data-commerce-product-id]").getAttribute("data-commerce-product-id")||"",n=e.getAttribute("data-commerce-sku-id")||e.querySelector("[data-commerce-sku-id]")&&e.querySelector("[data-commerce-sku-id]").getAttribute("data-commerce-sku-id")||"",a=e.querySelector('input[type="number"], input[data-node-type*="quantity"], .w-commerce-commercecartquantity input, input[name*="quantity" i]'),c=1;try{var o=parseInt(a&&a.value,10);c=isFinite(o)&&o>0?o:1}catch(e){}for(var i="",u=[".w-commerce-commercecartproductname",'[data-node-type*="product" i]',".text-block-18",".text-block-5","h1,h2,h3,h4,div,span"],d=0;d<u.length;d++){var m=e.querySelector(u[d]);if(m&&(m.textContent||"").trim()){i=(m.textContent||"").trim();break}}var l="",p=e.querySelector("img");p&&(l=p.getAttribute("src")||p.getAttribute("data-src")||"");var v=function(e,r){return r&&t.variantIdToKey[r]||e&&t.productIdToKey[e]||null}(r,n);return{el:e,productId:r,variantId:n,quantity:c,name:i,img:l,key:v}}):[]}function a(e,t){return document.querySelector('form[data-node-type="commerce-add-to-cart-form"][data-commerce-product-id="'+e+'"]')||document.querySelector('form[data-node-type="commerce-add-to-cart-form"][data-commerce-sku-id="'+t+'"]')}function c(e){return new Promise(function(t){var n=!1,a=r(),c=setTimeout(function(){n||(n=!0,t())},e||1500);if(a){var o=new MutationObserver(function(){if(!n){n=!0,clearTimeout(c);try{o.disconnect()}catch(e){}t()}});try{o.observe(a,{childList:!0,subtree:!0})}catch(e){}}})}function o(e,t){try{var r=e.querySelector('input[name="commerce-add-to-cart-quantity-input"]');r&&(r.value=t)}catch(e){}try{e.querySelectorAll("select[required]").forEach(function(e){if(!e.value){var t=e.querySelector('option[value]:not([value=""])');t&&(e.value=t.value)}})}catch(e){}var n=e.querySelector('input[data-node-type="commerce-add-to-cart-button"], [data-wf-cart-action="add-item"], [data-wf-cart-action*="add" i], input[type="submit"], button[type="submit"]');n&&n.click()}async function i(e,t){if(0!==t){if(t>0){var r=a(e.productId,e.variantId);if(!r)return;var n=c(1500);return o(r,t),void await n}var i=e.el.querySelector('input[type="number"], input[data-node-type*="quantity"], .w-commerce-commercecartquantity input, input[name*="quantity" i]');if(i){var d=parseInt(i.value,10)||1,m=Math.max(0,d+t);i.value=m;try{i.dispatchEvent(new Event("change",{bubbles:!0}))}catch(e){}await c(1500)}else{var l=u(e.el);if(l&&(l.click(),await c(1500),e.quantity+t>0)){var p=a(e.productId,e.variantId);if(p){var v=c(1500);o(p,e.quantity+t),await v}}}}}function u(e){for(var t=['[data-wf-cart-action="remove-item"]','[data-wf-cart-action*="remove" i]','[data-node-type="commerce-cart-remove-link"]','[data-node-type*="remove" i]','a[role="button"][aria-label*="remove" i]','button[aria-label*="remove" i]',".w-commerce-commercecartremovebutton",".w-commerce-commercecartremove"],r=0;r<t.length;r++){var n=e.querySelector(t[r]);if(n)return n}try{var a=Array.from(e.querySelectorAll("a,button,div,span")).filter(function(e){var t=(e.textContent||"").trim().toLowerCase();return"entfernen"===t||"remove"===t||t.indexOf("entfernen")>=0||t.indexOf("remove")>=0});if(a.length)return a[0]}catch(e){}return null}function d(){var t=n(),r=document.getElementById("fp-cart-items");r&&(r.innerHTML="",t.length||(r.innerHTML='<div class="fp-empty">Ihr Warenkorb ist leer.</div>'),t.forEach(function(e){var t=document.createElement("div");t.className="fp-cart-item";var n=document.createElement("img");n.src=e.img||"",n.alt=e.name||"";var a=document.createElement("div"),o=document.createElement("div");o.className="title",o.textContent=e.name||"Produkt";var d=document.createElement("div");d.className="meta",d.textContent=e.key||e.variantId||e.productId||"",a.appendChild(o),a.appendChild(d);var m=document.createElement("div");m.style.display="flex",m.style.alignItems="center",m.style.gap="8px";var l=document.createElement("div");l.className="qty";var p=document.createElement("button");p.className="btn outline",p.style.width="36px",p.textContent="−";var v=document.createElement("input");v.type="number",v.min="0",v.value=String(e.quantity);var y=document.createElement("button");y.className="btn outline",y.style.width="36px",y.textContent="+";var s=document.createElement("button");s.className="btn outline",s.textContent="Entfernen",l.appendChild(p),l.appendChild(v),l.appendChild(y),m.appendChild(l),m.appendChild(s),t.appendChild(n),t.appendChild(a),t.appendChild(m),p.addEventListener("click",async function(){var t=parseInt(v.value,10)||0;t>0&&(v.value=String(t-1),await i(e,-1))}),y.addEventListener("click",async function(){v.value=String((parseInt(v.value,10)||0)+1),await i(e,1)}),v.addEventListener("change",async function(){var t=parseInt(v.value,10);if(!isFinite(t)||t<0)v.value=String(e.quantity);else{var r=t-e.quantity;0!==r&&await i(e,r)}}),s.addEventListener("click",async function(){var t=u(e.el);t&&(t.click(),await c(1500))}),r.appendChild(t)}));var a=function(e){var t=0,r=!1;return e.forEach(function(e){var n=e.el.querySelector('.w-commerce-commercecartitemprice, [data-node-type*="price" i]');if(n){var a=(n.textContent||"").toLowerCase(),c=parseFloat(a.replace(/[^0-9,\.]/g,"").replace(".","").replace(",","."));isFinite(c)&&(t+=c,r=!0)}}),{subtotal:t,reliable:r}}(t);!function(t){var r=t||0;try{e()&&(r/=1.19)}catch(e){}try{document.getElementById("fp-subtotal").textContent=function(e){try{return(e||0).toFixed(2).replace(".",",")+" €"}catch(e){return"0,00 €"}}(r)}catch(e){}var n=document.getElementById("fp-summary-note");if(!n)return;!function(){try{return!e()}catch(e){return!0}}()?n.textContent="Firmenkunden wird die MwSt im Bestellprozess berechnet.":n.textContent="Bei den angebeben Preisen handelt es sich um Nettobeträge. Privatkunden profitieren von 0% MwSt Gemäß §12 Abs. 3 UstG"}(a.subtotal),function(){try{var e=document.querySelector('.w-commerce-commercecartcheckoutbutton, [data-node-type="cart-checkout-button"], [data-node-type*="checkout" i]'),t=document.getElementById("fp-checkout-slot");if(e&&t&&e!==t&&!t.contains(e)){var r=e.cloneNode(!0);r.addEventListener("click",function(e){e.preventDefault(),l()}),t.innerHTML="",t.appendChild(r)}}catch(e){}try{var n=document.querySelector('[data-node-type="commerce-cart-quick-checkout-button"], .w-commerce-commercecartquickcheckoutbutton'),a=document.getElementById("fp-quick-slot");if(n&&a&&n!==a&&!a.contains(n)){var c=n.cloneNode(!0);c.addEventListener("click",function(e){e.preventDefault();try{n.click()}catch(e){}}),a.innerHTML="",a.appendChild(c)}}catch(e){}try{var o=document.querySelector('[data-wf-paypal-button], [data-node-type="commerce-cart-quick-checkout-actions"] + div[id^="zoid-paypal-buttons"], [data-node-type="commerce-cart-quick-checkout-actions"] .paypal-buttons'),i=document.getElementById("fp-paypal-slot");if(o&&i){i.innerHTML="";var u=document.createElement("button");u.className="btn primary",u.textContent="Pay with PayPal",u.addEventListener("click",function(e){e.preventDefault();try{var t=document.querySelector(".paypal-buttons iframe.component-frame");t?t.contentWindow.postMessage({event:"click"},"*"):o.querySelector("iframe,button,a")?.click()}catch(e){}}),i.appendChild(u)}}catch(e){}}()}function m(){!function(){try{[window.PRODUCT_MAP||window.POPUP_PRODUCT_MAP_NETTO||{},window.PRODUCT_MAP_BRUTTO||window.POPUP_PRODUCT_MAP_BRUTTO||{}].forEach(function(e){Object.keys(e||{}).forEach(function(r){var n=e[r];n&&(n.productId&&(t.productIdToKey[n.productId]=r),n.variantId&&(t.variantIdToKey[n.variantId]=r))})})}catch(e){}}();var e=document.getElementById("fp-cart-notice");e&&(e.textContent="Preise netto angezeigt; Kundentyp-Steuerung aktiv.");var a=document.getElementById("fp-clear-all");a&&a.addEventListener("click",async function(){for(var e=0;;){var t=n();if(!t.length||e++>50)break;var r=u(t[0].el);if(!r)break;r.click(),await c(1500)}});var o=document.getElementById("fp-checkout");o&&o.addEventListener("click",function(){l()});var i=r();if(i)try{new MutationObserver(function(){d()}).observe(i,{childList:!0,subtree:!0})}catch(e){}try{window.CartCompatibility&&"function"==typeof window.CartCompatibility.schedule&&window.CartCompatibility.schedule(200)}catch(e){}d()}function l(){for(var e=['[data-node-type*="checkout" i]',".w-commerce-commercecartcheckoutbutton",'a[href*="checkout" i]'],t=0;t<e.length;t++){var r=document.querySelector(e[t]);if(r)try{return void r.click()}catch(e){}}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",m):m()}();