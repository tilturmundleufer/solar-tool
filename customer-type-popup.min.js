!function(){function t(){return"private"===n()}function e(){try{const e=["#gewerbe",'[data-customer-type="gewerbe"]','[data-customer-segment="gewerbe"]','[data-list="gewerbe"]',".collection-list-gewerbe"],r=t=>t.flatMap(t=>Array.from(document.querySelectorAll(t))),o=(t,e)=>t.forEach(t=>{t&&t.style&&(t.style.display=e?"none":"")}),n=r(["#privat",'[data-customer-type="privat"]','[data-customer-segment="privat"]','[data-list="privat"]',".collection-list-privat"]),a=r(e);o(n,!t()),o(a,t())}catch(t){}}function r(){try{const e=document.getElementById("nav-private"),r=document.getElementById("nav-business");e&&e.classList&&e.classList.toggle("stp-btn-active",t()),r&&r.classList&&r.classList.toggle("stp-btn-active",!t())}catch(t){}}function o(t){!function(t){try{const e=Date.now()+1728e5;localStorage.setItem("solarTool_customerType",JSON.stringify({type:t,expiresAt:e}))}catch(t){}}("business"===t?"business":"private"),e(),r();try{window.solarGrid&&(window.solarGrid.updateCurrentTotalPrice&&window.solarGrid.updateCurrentTotalPrice(),window.solarGrid.updateOverviewTotalPrice&&window.solarGrid.updateOverviewTotalPrice(),(window.solarGrid.ensureWebflowFormsMapped||window.solarGrid.generateHiddenCartForms)?.call(window.solarGrid))}catch(t){}}function n(){try{const t=localStorage.getItem("solarTool_customerType");if(!t)return null;const e=JSON.parse(t);return e&&e.type?"number"==typeof e.expiresAt&&Date.now()>e.expiresAt?(localStorage.removeItem("solarTool_customerType"),null):"private"===e.type?"private":"business":null}catch(t){return null}}function a(){const t=document.getElementById("customer-type-overlay");t&&(t.style.display="none",t.setAttribute("aria-hidden","true"))}function i(){const t=document.getElementById("nav-private"),i=document.getElementById("nav-business");t&&t.addEventListener("click",function(){o("private")}),i&&i.addEventListener("click",function(){o("business")});if(document.getElementById("customer-type-overlay")){const t=n(),e=document.getElementById("stp-private"),r=document.getElementById("stp-business");e&&e.addEventListener("click",function(){o("private"),a()}),r&&r.addEventListener("click",function(){o("business"),a()}),t||function(){const t=document.getElementById("customer-type-overlay");t&&(t.style.display="flex",t.setAttribute("aria-hidden","false"))}()}e(),r();try{CartCompatibility.init()}catch(t){}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i()}(),function(){var t=null,e=!1,r={productIdToKey:{},variantIdToKey:{}};function o(){try{if("object"==typeof PRODUCT_MAP&&PRODUCT_MAP&&Object.keys(PRODUCT_MAP).forEach(function(t){var e=PRODUCT_MAP[t];e&&e.productId&&(r.productIdToKey[e.productId]=t),e&&e.variantId&&(r.variantIdToKey[e.variantId]=t)}),"object"==typeof PRODUCT_MAP_BRUTTO&&PRODUCT_MAP_BRUTTO&&Object.keys(PRODUCT_MAP_BRUTTO).forEach(function(t){var e=PRODUCT_MAP_BRUTTO[t];e&&e.productId&&(r.productIdToKey[e.productId]=t),e&&e.variantId&&(r.variantIdToKey[e.variantId]=t)}),window.solarGrid&&"object"==typeof window.solarGrid){try{var t=window.solarGrid.webflowFormMap||{};Object.keys(t||{}).forEach(function(e){var o=t[e];if(o){var n=o.getAttribute("data-commerce-product-id"),a=o.getAttribute("data-commerce-sku-id");n&&(r.productIdToKey[n]=e),a&&(r.variantIdToKey[a]=e)}})}catch(t){}try{var o=window.solarGrid.webflowFormMapBrutto||{};Object.keys(o||{}).forEach(function(t){var e=o[t];if(e){var n=e.getAttribute("data-commerce-product-id"),a=e.getAttribute("data-commerce-sku-id");n&&(r.productIdToKey[n]=t),a&&(r.variantIdToKey[a]=t)}})}catch(t){}}e=!0}catch(t){}}function n(t,n){return e||o(),n&&r.variantIdToKey[n]?r.variantIdToKey[n]:t&&r.productIdToKey[t]?r.productIdToKey[t]:null}function a(t){try{var e=t.querySelector("[data-commerce-sku-id], [data-commerce-product-id]")||t;return{productId:e.getAttribute("data-commerce-product-id")||"",variantId:e.getAttribute("data-commerce-sku-id")||""}}catch(t){return{productId:"",variantId:""}}}function i(t){try{var e=t.querySelector('input[type="number"], input[data-node-type*="quantity"], .w-commerce-commercecartquantity input'),r=e?parseInt(e.value,10):NaN;return isFinite(r)&&r>0?r:1}catch(t){return 1}}function c(){return document.querySelector(".w-commerce-commercecartlist")||document.querySelector(".w-commerce-commercecartcontainerwrapper")}function d(t){return new Promise(function(e){var r=!1,o=c(),n=setTimeout(function(){r||(r=!0,e())},t||1500);if(o){var a=new MutationObserver(function(){r||(r=!0,clearTimeout(n),e());try{a.disconnect()}catch(t){}});try{a.observe(o,{childList:!0,subtree:!0})}catch(t){}}})}function u(e){try{t&&clearTimeout(t),t=setTimeout(m,Math.max(0,e||100))}catch(t){}}async function s(t){try{var e=function(t){for(var e=['[data-node-type="commerce-cart-remove-link"]','[data-node-type*="remove"]',".w-commerce-commercecartremovebutton",".w-commerce-commercecartremove",'button[aria-label*="Entfernen" i]','button[aria-label*="Remove" i]'],r=0;r<e.length;r++){var o=t.querySelector(e[r]);if(o)return o}return null}(t);if(!e)return;e.click(),await d(1500)}catch(t){console.warn("Cart: Entfernen fehlgeschlagen",t)}}async function l(t,e){try{if(window.solarGrid){try{(window.solarGrid.ensureWebflowFormsMapped||window.solarGrid.generateHiddenCartForms).call(window.solarGrid)}catch(t){}if("function"==typeof window.solarGrid.addSingleItemAndWait)return void await window.solarGrid.addSingleItemAndWait(t,e,!1);if("function"==typeof window.solarGrid.addProductToCart)return window.solarGrid.addProductToCart(t,e,!1),void await d(1500)}}catch(t){}console.warn("[CartCompat] Konnte kein Add-Flow ohne solarGrid ausführen. Item wird nicht ersetzt.")}async function m(){try{var t=c();if(!t)return;var r=Array.from(t.querySelectorAll('.w-commerce-commercecartitem, [data-node-type="commerce-cart-item"]'));if(!r.length)return;e||o();for(var d=0;d<r.length;d++){var u=r[d],m=a(u),y=n(m.productId,m.variantId);if(y){var p=isBusiness(),w=!1;try{"object"==typeof PRODUCT_MAP_BRUTTO&&PRODUCT_MAP_BRUTTO&&(w=Object.keys(PRODUCT_MAP_BRUTTO).some(function(t){var e=PRODUCT_MAP_BRUTTO[t];return e&&(e.productId===m.productId||e.variantId===m.variantId)}))}catch(t){}if(p!==w){var f=i(u);await s(u),await l(y,f)}}else console.warn("[CartCompat] Unbekanntes Produkt im Warenkorb; wird ignoriert.")}}catch(t){console.warn("Cart-Kompatibilitätsprüfung fehlgeschlagen:",t)}}window.CartCompatibility={init:function(){try{if(window.solarGrid&&(window.solarGrid.generateHiddenCartForms||window.solarGrid.ensureWebflowFormsMapped))try{(window.solarGrid.ensureWebflowFormsMapped||window.solarGrid.generateHiddenCartForms).call(window.solarGrid)}catch(t){}!function(){try{var t=c();if(t){var e=new MutationObserver(function(){u(50)});try{e.observe(t,{childList:!0,subtree:!0})}catch(t){}}var r=new MutationObserver(function(){u(100)});try{r.observe(document.body,{childList:!0,subtree:!0})}catch(t){}}catch(t){}}(),u(300)}catch(t){}}}}();