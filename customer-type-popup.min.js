!function(){function t(){return"private"===n()}function e(){try{const e=["#gewerbe",'[data-customer-type="gewerbe"]','[data-customer-segment="gewerbe"]','[data-list="gewerbe"]',".collection-list-gewerbe"],r=t=>t.flatMap(t=>Array.from(document.querySelectorAll(t))),o=(t,e)=>t.forEach(t=>{t&&t.style&&(t.style.display=e?"none":"")}),n=r(["#privat",'[data-customer-type="privat"]','[data-customer-segment="privat"]','[data-list="privat"]',".collection-list-privat"]),a=r(e);o(n,!t()),o(a,t())}catch(t){}}function r(){try{const e=document.getElementById("nav-private"),r=document.getElementById("nav-business");e&&e.classList&&e.classList.toggle("stp-btn-active",t()),r&&r.classList&&r.classList.toggle("stp-btn-active",!t())}catch(t){}}function o(t){!function(t){try{const e=Date.now()+1728e5;localStorage.setItem("solarTool_customerType",JSON.stringify({type:t,expiresAt:e}))}catch(t){}}("business"===t?"business":"private"),e(),r();try{window.solarGrid&&(window.solarGrid.updateCurrentTotalPrice&&window.solarGrid.updateCurrentTotalPrice(),window.solarGrid.updateOverviewTotalPrice&&window.solarGrid.updateOverviewTotalPrice(),(window.solarGrid.ensureWebflowFormsMapped||window.solarGrid.generateHiddenCartForms)?.call(window.solarGrid))}catch(t){}}function n(){try{const t=localStorage.getItem("solarTool_customerType");if(!t)return null;const e=JSON.parse(t);return e&&e.type?"number"==typeof e.expiresAt&&Date.now()>e.expiresAt?(localStorage.removeItem("solarTool_customerType"),null):"private"===e.type?"private":"business":null}catch(t){return null}}function a(){const t=document.getElementById("customer-type-overlay");t&&(t.style.display="none",t.setAttribute("aria-hidden","true"))}function c(){const t=document.getElementById("nav-private"),c=document.getElementById("nav-business");t&&t.addEventListener("click",function(){o("private")}),c&&c.addEventListener("click",function(){o("business")});if(document.getElementById("customer-type-overlay")){const t=n(),e=document.getElementById("stp-private"),r=document.getElementById("stp-business");e&&e.addEventListener("click",function(){o("private"),a()}),r&&r.addEventListener("click",function(){o("business"),a()}),t||function(){const t=document.getElementById("customer-type-overlay");t&&(t.style.display="flex",t.setAttribute("aria-hidden","false"))}()}e(),r();try{CartCompatibility.init()}catch(t){}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c):c()}(),function(){var t=null,e=!1,r={productIdToKey:{},variantIdToKey:{}},o=!1;function n(t){try{t&&"object"==typeof t&&(t.PRODUCT_MAP&&"object"==typeof t.PRODUCT_MAP&&Object.keys(t.PRODUCT_MAP).length&&(window.PRODUCT_MAP=window.PRODUCT_MAP||t.PRODUCT_MAP),t.PRODUCT_MAP_BRUTTO&&"object"==typeof t.PRODUCT_MAP_BRUTTO&&Object.keys(t.PRODUCT_MAP_BRUTTO).length&&(window.PRODUCT_MAP_BRUTTO=window.PRODUCT_MAP_BRUTTO||t.PRODUCT_MAP_BRUTTO))}catch(t){}}function a(t){return new Promise(function(e){try{fetch(t,{credentials:"omit",cache:"no-store"}).then(function(t){if(!t.ok)return e(null);t.json().then(function(t){e(t)}).catch(function(){e(null)})}).catch(function(){e(null)})}catch(t){e(null)}})}function c(){try{if("object"==typeof PRODUCT_MAP&&PRODUCT_MAP&&Object.keys(PRODUCT_MAP).forEach(function(t){var e=PRODUCT_MAP[t];e&&e.productId&&(r.productIdToKey[e.productId]=t),e&&e.variantId&&(r.variantIdToKey[e.variantId]=t)}),"object"==typeof PRODUCT_MAP_BRUTTO&&PRODUCT_MAP_BRUTTO&&Object.keys(PRODUCT_MAP_BRUTTO).forEach(function(t){var e=PRODUCT_MAP_BRUTTO[t];e&&e.productId&&(r.productIdToKey[e.productId]=t),e&&e.variantId&&(r.variantIdToKey[e.variantId]=t)}),window.solarGrid&&"object"==typeof window.solarGrid){try{var t=window.solarGrid.webflowFormMap||{};Object.keys(t||{}).forEach(function(e){var o=t[e];if(o){var n=o.getAttribute("data-commerce-product-id"),a=o.getAttribute("data-commerce-sku-id");n&&(r.productIdToKey[n]=e),a&&(r.variantIdToKey[a]=e)}})}catch(t){}try{var o=window.solarGrid.webflowFormMapBrutto||{};Object.keys(o||{}).forEach(function(t){var e=o[t];if(e){var n=e.getAttribute("data-commerce-product-id"),a=e.getAttribute("data-commerce-sku-id");n&&(r.productIdToKey[n]=t),a&&(r.variantIdToKey[a]=t)}})}catch(t){}}e=!0}catch(t){}}function i(t,o){return e||c(),o&&r.variantIdToKey[o]?r.variantIdToKey[o]:t&&r.productIdToKey[t]?r.productIdToKey[t]:null}function d(t){try{var e=t.querySelector("[data-commerce-sku-id], [data-commerce-product-id]")||t;return{productId:e.getAttribute("data-commerce-product-id")||"",variantId:e.getAttribute("data-commerce-sku-id")||""}}catch(t){return{productId:"",variantId:""}}}function u(t){try{var e=t.querySelector('input[type="number"], input[data-node-type*="quantity"], .w-commerce-commercecartquantity input'),r=e?parseInt(e.value,10):NaN;return isFinite(r)&&r>0?r:1}catch(t){return 1}}function l(){return document.querySelector(".w-commerce-commercecartlist")||document.querySelector(".w-commerce-commercecartcontainerwrapper")}function s(t){return new Promise(function(e){var r=!1,o=l(),n=setTimeout(function(){r||(r=!0,e())},t||1500);if(o){var a=new MutationObserver(function(){r||(r=!0,clearTimeout(n),e());try{a.disconnect()}catch(t){}});try{a.observe(o,{childList:!0,subtree:!0})}catch(t){}}})}function w(e){try{t&&clearTimeout(t),t=setTimeout(m,Math.max(0,e||100))}catch(t){}}async function f(t){try{var e=function(t){for(var e=['[data-node-type="commerce-cart-remove-link"]','[data-node-type*="remove"]',".w-commerce-commercecartremovebutton",".w-commerce-commercecartremove",'button[aria-label*="Entfernen" i]','button[aria-label*="Remove" i]'],r=0;r<e.length;r++){var o=t.querySelector(e[r]);if(o)return o}return null}(t);if(!e)return;e.click(),await s(1500)}catch(t){console.warn("Cart: Entfernen fehlgeschlagen",t)}}async function T(t,e){try{if(window.solarGrid){try{(window.solarGrid.ensureWebflowFormsMapped||window.solarGrid.generateHiddenCartForms).call(window.solarGrid)}catch(t){}if("function"==typeof window.solarGrid.addSingleItemAndWait)return void await window.solarGrid.addSingleItemAndWait(t,e,!1);if("function"==typeof window.solarGrid.addProductToCart)return window.solarGrid.addProductToCart(t,e,!1),void await s(1500)}}catch(t){}console.warn("[CartCompat] Konnte kein Add-Flow ohne solarGrid ausführen. Item wird nicht ersetzt.")}async function m(){try{var t=l();if(!t)return;var r=Array.from(t.querySelectorAll('.w-commerce-commercecartitem, [data-node-type="commerce-cart-item"]'));if(!r.length)return;e||c();for(var o=0;o<r.length;o++){var n=r[o],a=d(n),s=i(a.productId,a.variantId);if(s){var w=isBusiness(),m=!1;try{"object"==typeof PRODUCT_MAP_BRUTTO&&PRODUCT_MAP_BRUTTO&&(m=Object.keys(PRODUCT_MAP_BRUTTO).some(function(t){var e=PRODUCT_MAP_BRUTTO[t];return e&&(e.productId===a.productId||e.variantId===a.variantId)}))}catch(t){}if(w!==m){var P=u(n);await f(n),await T(s,P)}}else console.warn("[CartCompat] Unbekanntes Produkt im Warenkorb; wird ignoriert.")}}catch(t){console.warn("Cart-Kompatibilitätsprüfung fehlgeschlagen:",t)}}window.CartCompatibility={init:function(){try{new Promise(function(t){try{if(o)return t(!0);if("object"==typeof window.PRODUCT_MAP&&window.PRODUCT_MAP&&"object"==typeof window.PRODUCT_MAP_BRUTTO&&window.PRODUCT_MAP_BRUTTO)return o=!0,t(!0);if(n(window),"object"==typeof window.PRODUCT_MAP&&window.PRODUCT_MAP&&"object"==typeof window.PRODUCT_MAP_BRUTTO&&window.PRODUCT_MAP_BRUTTO)return o=!0,t(!0);a(window.SOLAR_TOOL_PRODUCT_MAPS_URL||"/product-maps.json").then(function(e){e&&n(e),window.PRODUCT_MAP&&window.PRODUCT_MAP_BRUTTO?(o=!0,t(!0)):a("https://solar-tool-xi.vercel.app/product-maps.json").then(function(e){if(e&&n(e),!window.PRODUCT_MAP||!window.PRODUCT_MAP_BRUTTO){var r={PRODUCT_MAP_FALLBACK:{Solarmodul:{productId:"685003af0e41d945fb0198d8",variantId:"685003af4a8e88cb58c89d46"},UlicaSolarBlackJadeFlow:{productId:"689455ed543f0cbb26ba54e9",variantId:"689455ed7d7ddfd326d5dbf9"},SolarmodulPalette:{productId:"68b999a74abecff30536dee0",variantId:"68b999a873f9b0df7954ed8b"}},PRODUCT_MAP_BRUTTO_FALLBACK:{Solarmodul:{productId:"68c7ec7571df9723b8ef5050",variantId:"68c7ec7e71df9723b8ef53cd"}}};window.PRODUCT_MAP=window.PRODUCT_MAP||r.PRODUCT_MAP_FALLBACK,window.PRODUCT_MAP_BRUTTO=window.PRODUCT_MAP_BRUTTO||r.PRODUCT_MAP_BRUTTO_FALLBACK}o=!0,t(!0)})})}catch(r){var e={PRODUCT_MAP_FALLBACK:{Solarmodul:{productId:"685003af0e41d945fb0198d8",variantId:"685003af4a8e88cb58c89d46"},UlicaSolarBlackJadeFlow:{productId:"689455ed543f0cbb26ba54e9",variantId:"689455ed7d7ddfd326d5dbf9"},SolarmodulPalette:{productId:"68b999a74abecff30536dee0",variantId:"68b999a873f9b0df7954ed8b"}},PRODUCT_MAP_BRUTTO_FALLBACK:{Solarmodul:{productId:"68c7ec7571df9723b8ef5050",variantId:"68c7ec7e71df9723b8ef53cd"}}};window.PRODUCT_MAP=window.PRODUCT_MAP||e.PRODUCT_MAP_FALLBACK,window.PRODUCT_MAP_BRUTTO=window.PRODUCT_MAP_BRUTTO||e.PRODUCT_MAP_BRUTTO_FALLBACK,o=!0,t(!0)}}).then(function(){if(window.solarGrid&&(window.solarGrid.generateHiddenCartForms||window.solarGrid.ensureWebflowFormsMapped))try{(window.solarGrid.ensureWebflowFormsMapped||window.solarGrid.generateHiddenCartForms).call(window.solarGrid)}catch(t){}e||c(),function(){try{var t=l();if(t){var e=new MutationObserver(function(){w(50)});try{e.observe(t,{childList:!0,subtree:!0})}catch(t){}}var r=new MutationObserver(function(){w(100)});try{r.observe(document.body,{childList:!0,subtree:!0})}catch(t){}}catch(t){}}(),w(300)})}catch(t){}}}}();