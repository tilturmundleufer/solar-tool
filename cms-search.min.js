!function(){var e=!1;function t(e){try{return(e||"").toString().toLowerCase().replace(/[^\w\s]/g," ").replace(/\s+/g," ").trim()}catch(e){return""}}function r(e){try{console.log("[CMS-SEARCH] Finding root for input:",e);for(var t=e,r=0;r<6&&t;r++){var a=t.querySelector&&t.querySelector(".search-cms-wrapper-2, .search-cms-wrapper");if(a)return console.log("[CMS-SEARCH] Found wrapper in parent:",a.className),a;t=t.parentElement}var n=document.querySelector(".search-cms-wrapper-2, .search-cms-wrapper");if(n)return console.log("[CMS-SEARCH] Found global wrapper:",n.className),n;var o=e.closest("form");if(o){var s=o.querySelector(".search-cms-wrapper-2, .search-cms-wrapper");if(s)return console.log("[CMS-SEARCH] Found form wrapper:",s.className),s}return console.log("[CMS-SEARCH] No wrapper found, using document"),document}catch(e){return console.error("[CMS-SEARCH] getListRootForInput error:",e),document}}function a(e){try{var a=(e.getAttribute("data-input")||"").toString().match(/^search-(.+)$/);if(!a)return;var n=a[1],o=r(e)||document,s=t(e.value||""),c=Array.prototype.slice.call(o.querySelectorAll('[data-search="cms-item-'+n+'"], [data-search="cms_item_'+n+'"], .search-cms-item-2, .search-cms-item'));if(console.log("[CMS-SEARCH] handle input",{key:n,term:s,items:c.length}),c.length>0){console.log("[CMS-SEARCH] Found items:",c.map(function(e){var t=e.querySelector(".search-name");return t?t.textContent:"No name element"}));for(var l=0;l<Math.min(3,c.length);l++){var i=c[l],u=getComputedStyle(i);console.log("[CMS-SEARCH] Item visibility check:",{name:i.querySelector(".search-name")?.textContent||"No name",display:u.display,visibility:u.visibility,opacity:u.opacity})}}if(""===s){for(var d=0;d<c.length;d++)c[d].style.display="none";var p=o.querySelector('[data-div="noResult-'+n+'"]');if(p&&(p.style.display="none"),"true"===(e.getAttribute("data-url")||"").toString().toLowerCase())try{var y=new URL(window.location.href);y.searchParams.delete("search-"+n),window.history.pushState({},"",y)}catch(e){}try{var m=o.querySelector('.search-cms-wrapper-2, .search-cms-wrapper, [role="list"]');m&&(m.style.display="none");var h=o.querySelector('[role="list"], .search-cms-list, .w-dyn-items');h&&(h.style.display="none")}catch(e){}return}for(var S=0,v=0;v<c.length;v++){var g=(H=c[v]).querySelector(".search-name"),C=g?t(g.textContent||""):"";C||(C=t(H.textContent||"")),-1!==C.indexOf(s)?(H.style.display="",S++,console.log("[CMS-SEARCH] Match found:",C,"for term:",s)):H.style.display="none"}for(var f=c.length,w=0,A=0;A<c.length;A++)"none"===getComputedStyle(c[A]).display&&w++;var R=o.querySelector('[data-div="noResult-'+n+'"], [data-div="noResult_'+n+'"]');R&&(R.style.display=f>0&&w===f?"":"none");try{console.log("[CMS-SEARCH] Wrapper visibility check:",{anyVisible:S,term:s,total:f});var E=o.querySelector('.search-cms-wrapper-2, .search-cms-wrapper, [role="list"]'),b=o.querySelector('[role="list"], .search-cms-list, .w-dyn-items');if(console.log("[CMS-SEARCH] Found wrappers:",{wrapper:E?E.className:"none",listEl:b?b.className:"none"}),E&&(S>0&&s?(E.style.display="block",E.style.visibility="visible",console.log("[CMS-SEARCH] Showing wrapper:",E.className)):(E.style.display="none",console.log("[CMS-SEARCH] Hiding wrapper:",E.className))),b&&(S>0&&s?(b.style.display="block",b.style.visibility="visible",console.log("[CMS-SEARCH] Showing list:",b.className)):(b.style.display="none",console.log("[CMS-SEARCH] Hiding list:",b.className))),S>0)for(var M=0;M<c.length;M++){var H=c[M];"none"!==getComputedStyle(H).display&&(H.style.display="block",H.style.visibility="visible")}}catch(e){console.error("[CMS-SEARCH] Wrapper error:",e)}if("true"===(e.getAttribute("data-url")||"").toString().toLowerCase())try{var q=new URL(window.location.href);q.searchParams.set("search-"+n,e.value),window.history.pushState({},"",q)}catch(e){}}catch(e){console.error("[CMS-SEARCH] Error:",e)}}function n(){try{if(e)return;e=!0,console.log("[CMS-SEARCH] init binding events"),document.addEventListener("input",function(e){var t=e.target;try{if(!t||!t.matches||!t.matches('[data-input^="search-"]'))return}catch(e){return}console.log("[CMS-SEARCH] input event fired"),a(t)},!0),document.addEventListener("keyup",function(e){var t=e.target;try{if(!t||!t.matches||!t.matches('[data-input^="search-"]'))return}catch(e){return}console.log("[CMS-SEARCH] keyup event fired"),a(t)},!0),document.addEventListener("focusin",function(e){var a=e.target;try{if(!a||!a.matches||!a.matches('[data-input^="search-"]'))return}catch(e){return}var n=(a.getAttribute("data-input")||"").toString().match(/^search-(.+)$/);if(n){var o=n[1],s=r(a)||document,c=s.querySelectorAll('[data-search="cms-item-'+o+'"], [data-search="cms_item_'+o+'"]'),l=t(a.value||"");if(l){for(var i=0;i<c.length;i++){var u=c[i],d=u.querySelector(".search-name"),p=-1!==t(d?d.textContent||"":u.textContent||"").indexOf(l);u.style.display=p?"":"none"}var y=s.querySelector('.search-cms-wrapper-2, .search-cms-wrapper, [role="list"]');y&&(y.style.display="block")}}},!0),document.addEventListener("focusout",function(e){var t=e.target;try{if(!t||!t.matches||!t.matches('[data-input^="search-"]'))return}catch(e){return}var a=(t.getAttribute("data-input")||"").toString().match(/^search-(.+)$/);if(a){a[1];var n=(r(t)||document).querySelector('.search-cms-wrapper-2, .search-cms-wrapper, [role="list"]');n&&(n.style.display="none")}},!0);for(var n=document.querySelectorAll('[data-input^="search-"]'),o=0;o<n.length;o++){var s=n[o],c=(s.getAttribute("data-input")||"").match(/^search-(.+)$/);if(c){var l=c[1],i=(r(s)||document).querySelector('[data-div="noResult-'+l+'"], [data-div="noResult_'+l+'"]');i&&(i.style.display="none");try{if("true"===(s.getAttribute("data-url")||"").toString().toLowerCase()){var u=new URLSearchParams(window.location.search).get("search-"+l);u&&(s.value=u,a(s))}}catch(e){}try{a(s)}catch(e){}}}}catch(e){}}window.CmsSearch={init:n,handleInput:a,normalizeText:t},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",n):n()}();