!function(){var e=!1;function t(e){try{return(e||"").toString().toLowerCase().replace(/[^\w\s]/g," ").replace(/\s+/g," ").trim()}catch(e){return""}}function r(e){try{console.log("[CMS-SEARCH] Finding root for input:",e);for(var t=e,r=0;r<6&&t;r++){var a=t.querySelector&&t.querySelector(".search-cms-wrapper-2, .search-cms-wrapper");if(a)return console.log("[CMS-SEARCH] Found wrapper in parent:",a.className),a;t=t.parentElement}var o=document.querySelector(".search-cms-wrapper-2, .search-cms-wrapper");if(o)return console.log("[CMS-SEARCH] Found global wrapper:",o.className),o;var n=e.closest("form");if(n){var s=n.querySelector(".search-cms-wrapper-2, .search-cms-wrapper");if(s)return console.log("[CMS-SEARCH] Found form wrapper:",s.className),s}return console.log("[CMS-SEARCH] No wrapper found, using document"),document}catch(e){return console.error("[CMS-SEARCH] getListRootForInput error:",e),document}}function a(e){try{var a=(e.getAttribute("data-input")||"").toString().match(/^search-(.+)$/);if(!a)return;var o=a[1],n=r(e)||document,s=t(e.value||""),c=Array.prototype.slice.call(n.querySelectorAll('[data-search="cms-item-'+o+'"], [data-search="cms_item_'+o+'"], .search-cms-item-2, .search-cms-item'));if(console.log("[CMS-SEARCH] handle input",{key:o,term:s,items:c.length}),c.length>0){console.log("[CMS-SEARCH] Found items:",c.map(function(e){var t=e.querySelector(".search-name");return t?t.textContent:"No name element"}));for(var i=0;i<Math.min(3,c.length);i++){var l=c[i],u=getComputedStyle(l);console.log("[CMS-SEARCH] Item visibility check:",{name:l.querySelector(".search-name")?.textContent||"No name",display:u.display,visibility:u.visibility,opacity:u.opacity})}}if(""===s){for(var d=0;d<c.length;d++)c[d].style.display="none";var m=n.querySelector('[data-div="noResult-'+o+'"]');if(m&&(m.style.display="none"),"true"===(e.getAttribute("data-url")||"").toString().toLowerCase())try{var p=new URL(window.location.href);p.searchParams.delete("search-"+o),window.history.pushState({},"",p)}catch(e){}try{var h=n.querySelector('.search-cms-wrapper-2, .search-cms-wrapper, [role="list"]');h&&(h.style.display="none");var y=n.querySelector('[role="list"], .search-cms-list, .w-dyn-items');y&&(y.style.display="none")}catch(e){}return}for(var S=0,v=0;v<c.length;v++){var g=(H=c[v]).querySelector(".search-name"),f=g?t(g.textContent||""):"";f||(f=t(H.textContent||"")),-1!==f.indexOf(s)?(H.style.display="",S++,console.log("[CMS-SEARCH] Match found:",f,"for term:",s)):H.style.display="none"}for(var C=c.length,w=0,A=0;A<c.length;A++)"none"===getComputedStyle(c[A]).display&&w++;var E=n.querySelector('[data-div="noResult-'+o+'"], [data-div="noResult_'+o+'"]');E&&(E.style.display=C>0&&w===C?"":"none");try{console.log("[CMS-SEARCH] Wrapper visibility check:",{anyVisible:S,term:s,total:C});var R=n.querySelector('.search-cms-wrapper-2, .search-cms-wrapper, [role="list"]'),b=n.querySelector('[role="list"], .search-cms-list, .w-dyn-items');if(console.log("[CMS-SEARCH] Found wrappers:",{wrapper:R?R.className:"none",listEl:b?b.className:"none"}),R&&(S>0&&s?(R.style.display="block",R.style.visibility="visible",console.log("[CMS-SEARCH] Showing wrapper:",R.className)):(R.style.display="none",console.log("[CMS-SEARCH] Hiding wrapper:",R.className))),b&&(S>0&&s?(b.style.display="block",b.style.visibility="visible",console.log("[CMS-SEARCH] Showing list:",b.className)):(b.style.display="none",console.log("[CMS-SEARCH] Hiding list:",b.className))),S>0)for(var M=0;M<c.length;M++){var H=c[M];"none"!==getComputedStyle(H).display&&(H.style.display="block",H.style.visibility="visible")}}catch(e){console.error("[CMS-SEARCH] Wrapper error:",e)}if("true"===(e.getAttribute("data-url")||"").toString().toLowerCase())try{var q=new URL(window.location.href);q.searchParams.set("search-"+o,e.value),window.history.pushState({},"",q)}catch(e){}}catch(e){console.error("[CMS-SEARCH] Error:",e)}}function o(){try{if(e)return;e=!0,console.log("[CMS-SEARCH] init binding events");var o=!1;document.addEventListener("input",function(e){var t=e.target;try{if(!t||!t.matches||!t.matches('[data-input^="search-"]'))return}catch(e){return}console.log("[CMS-SEARCH] input event fired"),a(t)},!0),document.addEventListener("keyup",function(e){var t=e.target;try{if(!t||!t.matches||!t.matches('[data-input^="search-"]'))return}catch(e){return}console.log("[CMS-SEARCH] keyup event fired"),a(t)},!0),document.addEventListener("focusin",function(e){var a=e.target;try{if(!a||!a.matches||!a.matches('[data-input^="search-"]'))return}catch(e){return}var o=(a.getAttribute("data-input")||"").toString().match(/^search-(.+)$/);if(o){var n=o[1],s=r(a)||document,c=s.querySelectorAll('[data-search="cms-item-'+n+'"], [data-search="cms_item_'+n+'"]'),i=t(a.value||"");if(i){for(var l=0;l<c.length;l++){var u=c[l],d=u.querySelector(".search-name"),m=-1!==t(d?d.textContent||"":u.textContent||"").indexOf(i);u.style.display=m?"":"none"}var p=s.querySelector('.search-cms-wrapper-2, .search-cms-wrapper, [role="list"]');p&&(p.style.display="block")}}},!0),document.addEventListener("mousedown",function(e){e.target.closest&&e.target.closest('[data-search^="cms-item-"], [data-search^="cms_item_"], .search-cms-item-2, .search-cms-item')&&(o=!0,setTimeout(function(){o=!1},300))},!0),document.addEventListener("focusout",function(e){var t=e.target;try{if(!t||!t.matches||!t.matches('[data-input^="search-"]'))return}catch(e){return}if(!o){var a=(t.getAttribute("data-input")||"").toString().match(/^search-(.+)$/);if(a){a[1];var n=(r(t)||document).querySelector('.search-cms-wrapper-2, .search-cms-wrapper, [role="list"]');setTimeout(function(){if(!o){var e=document.activeElement,t=n&&(n.contains(e)||e&&e.closest&&e.closest('.search-cms-wrapper-2, .search-cms-wrapper, [role="list"]'));n&&!t&&(n.style.display="none")}},150)}}},!0);for(var n=document.querySelectorAll('[data-input^="search-"]'),s=0;s<n.length;s++){var c=n[s],i=(c.getAttribute("data-input")||"").match(/^search-(.+)$/);if(i){var l=i[1],u=(r(c)||document).querySelector('[data-div="noResult-'+l+'"], [data-div="noResult_'+l+'"]');u&&(u.style.display="none");try{if("true"===(c.getAttribute("data-url")||"").toString().toLowerCase()){var d=new URLSearchParams(window.location.search).get("search-"+l);d&&(c.value=d,a(c))}}catch(e){}try{a(c)}catch(e){}}}}catch(e){}}window.CmsSearch={init:o,handleInput:a,normalizeText:t},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o()}();